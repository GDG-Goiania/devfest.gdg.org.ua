<dom-module id="cod-block">
    <template>
        <style>
            :host {
                display: none;
                position: absolute;
            }

            .paper-card-container {
                padding: 16px 0;
            }

            .title {
                color: var(--default-primary-color);
                font-size: 42px;
            }

            .posted {
                font-size: 14px;
                color: var(--secondary-text-color);
            }
    
            @media (min-width: 768px) {
                paper-card {
                    width: 80%;
                }
                .paper-card-container {
                    padding: 50px 40px;
                }
            }
        </style>
        <iron-ajax id="ajax" url="[[postUrl]]" handle-as="text" on-response="postLoaded"></iron-ajax>
        <div class="relative layout horizontal center-justified">
            <paper-card>
                <div class="paper-card-container">
                    <!-- <div class="card-content">
                        <span class="title block">Or don't be a jerk policy</span>
                    </div> -->
                    <div class="card-content">
                        <marked-element markdown="[[post]]"></marked-element>
                    </div>
                </div>
            </paper-card>
        </div>
    </template>
</dom-module>
<script>
Polymer({
    is: 'cod-block',
    behaviors: [
        Polymer.NeonSharedElementAnimatableBehavior
    ],
    properties: {
        source: {
            type: String,
            observer: '_sourceChanged'
        },
        animationConfig: {
            value: function() {
                return {
                    'entry': {
                        name: 'transform-animation',
                        node: this,
                        transformFrom: 'translateY(100vh)',
                        transformTo: 'none',
                        timing: {
                            duration: 1000
                        }
                    },
                    'exit': {
                        name: 'transform-animation',
                        node: this,
                        transformFrom: 'none',
                        transformTo: 'translateY(100vh)',
                        timing: {
                            duration: 1000
                        }
                    }
                };
            }
        },
        closing: {
            type: Boolean,
            notify: true
        }
    },
    _sourceChanged: function() {
        this.postUrl = this.source;
        this.style.display = 'block';
        this.$.ajax.generateRequest();
    },
    postLoaded: function(event, response) {
        this.post = response.response;
        this.style.position = 'relative';
    },
    closePost: function() {
        this.closing = true;
    }
});
</script>
